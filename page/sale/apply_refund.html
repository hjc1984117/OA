<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
    <!--<![endif]-->
    <head>
        <meta charset="utf-8"/>
        <title>星密码OA管理系统-退款申请</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <meta content="" name="description"/>
        <meta content="" name="author"/>
        <link href="../../assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <link href="../../assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
        <link href="../../assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <!-- END GLOBAL MANDATORY STYLES -->
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.css">
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css">
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/bootstrap-datepicker/css/datepicker.css">
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/bootstrap-toastr/toastr.min.css">
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/jstree/dist/themes/default/style.min.css">
        <link rel="stylesheet" type="text/css" href="../../assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
        <!-- BEGIN THEME STYLES -->
        <link href="../../assets/local/css/components.css" rel="stylesheet" type="text/css"/>
        <link href="../../assets/local/css/plugins.css" rel="stylesheet" type="text/css"/>
        <link href="../../assets/local/css/base.css" rel="stylesheet" type="text/css"/>
        <!-- END THEME STYLES -->
        <link rel="shortcut icon" href="../../assets/global/img/favicon.ico"/>
    </head>
    <body style="background: #ffffff;margin: 0px;padding: 0px;">
        <div class="modal fade bs-example-modal-lg" id="myexcelModal" tabindex="-1" role="dialog" aria-hidden="false">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">导出EXCEL</h4>
                    </div>
                    <div class="modal-body">
                        <form id="toexcel_form" class="form-horizontal" novalidate="novalidate">
                            <div class="form-body">
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="type">导出时间类型<span class="required">*</span></label>
                                    <div class="col-md-3">
                                        <div class="input-icon right">
                                            <i class="fa"></i>
                                            <select class="form-control" readonly="" name="type" id="type"  placeholder="导出时间类型">
                                                <option value="1">添加时间</option>
                                                <option value="2">介入时间</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="ww">申请日期<span class="required">*</span></label>
                                    <div class="col-md-3">
                                        <div class="input-icon right">
                                            <i class="fa"></i>
                                            <input type="text" class="form-control date-picker-bind-mouseover not-clear" readonly="" data-date-format="yyyy-mm-dd" name="start_time" id="start_time"  placeholder="开始时间" aria-required="true" aria-invalid="true"/>
                                        </div>
                                    </div>
                                    <label class="control-label col-md-2" for="name">结束日期<span class="required">*</span></label>
                                    <div class="col-md-3">
                                        <div class="input-icon right">
                                            <i class="fa"></i>
                                            <input type="text" class="form-control date-picker-bind-mouseover not-clear" readonly="" data-date-format="yyyy-mm-dd" name="end_time" id="end_time"  placeholder="结束时间" aria-required="true" aria-invalid="true"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="btn_toexcel_primary">确认导出</button>
                        <button type="button" class="btn btn-default" id="btn_close_primary" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade bs-example-modal-lg in" id="remarkModal" tabindex="-1" role="dialog" aria-hidden="false">
            <div class="modal-dialog modal-body">
                <div class="modal-content ui-draggable" style="left: -130px; top: 138px;">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                        <h4 class="modal-title" id="myModalLabel">添加退款备注</h4>
                    </div>
                    <div class="modal-body">
                        <form id="add_remark_form" class="form-horizontal" novalidate="novalidate">
                            <div class="form-body">
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <input type="hidden" name="rid" id="rid" value="">
                                        <textarea class="form-control" rows="10" placeholder="备注" id="remark" name="remark"></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="btn_remark_primary">确认添加</button>
                        <button type="button" class="btn btn-default" id="btn_remark_close_primary" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade bs-example-modal-lg" id="apply_refund" tabindex="-1" role="dialog" aria-hidden="false">
            <div class="modal-dialog modal-body">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">退款申请</h4>
                    </div>
                    <div class="modal-body">
                        <form id="add_apply_refund_form" class="form-horizontal" novalidate="novalidate">
                            <div class="form-body">
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="quit_write">快捷填单<span class="required">*</span></label>
                                    <div class="col-md-10">
                                        <input type="hidden" id="sale_id" name="sale_id">
                                        <textarea class="form-control" placeholder="输入QQ/旺旺/名字后回车自动补全表单" id="quit_write"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="sale_addtime">添加时间<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="销售记录添加时间" id="sale_addtime" name="sale_addtime">
                                    </div>
                                    <label class="control-label col-md-2" for="name">客户姓名<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="销售记录添加时间" id="name" name="name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="ww">旺旺<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="旺旺" id="ww" name="ww">
                                    </div>
                                    <label class="control-label col-md-2" for="qq">QQ<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="QQ" id="qq" name="qq">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="mobile">客户电话<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="客户电话" id="mobile" name="mobile">
                                    </div>
                                    <label class="control-label col-md-2" for="money">销售金额<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="销售金额" id="money" name="money">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="payment">收款方式<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="收款方式" id="payment" name="payment">
                                    </div>
                                    <label class="control-label col-md-2" for="nick_name">售后<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="售后" id="nick_name" name="nick_name">
                                        <input type="hidden" id="customer_id" name="customer_id">
                                        <input type="hidden" id="customer" name="customer">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="arrears">欠款<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="欠款" id="arrears" name="arrears">
                                    </div>
                                    <label class="control-label col-md-2" for="done_username">处理人员<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control" placeholder="处理人员" id="done_username" name="done_username">
                                        <input type="hidden" id="done_userid" name="done_userid">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="apply_time">申请时间</label>
                                    <div class="col-md-4">
                                        <input type="text" readonly="" class="form-control date-time-picker-bind-mouseover" data-date-format="yyyy-mm-dd hh:ii:ss" placeholder="申请时间(为空默认当前时间)" id="apply_time" name="apply_time">
                                    </div>
                                    <label class="control-label col-md-2" for="rstatus">申请方式<span class="required">*</span></label>
                                    <div class="col-md-4">
                                        <select readonly="" class="form-control" placeholder="申请方式" id="rstatus" name="rstatus">
                                            <option value="退款">退款</option>
                                            <option value="售后">售后</option>
                                            <!--                                            <option value="400">400</option>
                                                                                        <option value="站内信">站内信</option>
                                                                                        <option value="负面">负面</option>
                                                                                        <option value="店铺">店铺</option>
                                                                                        <option value="官网">官网</option>
                                                                                        <option value="邮箱">邮箱</option>
                                                                                        <option value="旺旺">旺旺</option>-->
                                            <option value="其他">其他</option>
                                        </select>                                        
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="reason">退款原因<span class="required">*</span></label>
                                    <div class="col-md-10">
                                        <div class="input-icon right">
                                            <i class="fa"></i>
                                            <input type="text" class="form-control not-clear" placeholder="退款原因" id="reason" name="reason">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="remark">申请时间</label>
                                    <div class="col-md-10">
                                        <textarea type="text" class="form-control" placeholder="备注" id="remark" name="remark"></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="btn_apply_refund_primary">确认添加</button>
                        <button type="button" class="btn btn-default" id="btn_pply_refund_close_primary" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="page-bar">
            <ul class="page-breadcrumb">
                <li><i class="fa fa-home"></i><a href="#">Home</a><i class="fa fa-angle-right"></i></li>
                <li><a href="#">销售统计</a><i class="fa fa-angle-right"></i></li>
                <li><a href="#">退款申请</a></li>
            </ul>
        </div>
        <div class="permit_buttons">
            <button type="button" id="open_apply_refund_btn" class="btn red-sunglo permit_2011401" data-toggle="modal" data-target="#apply_refund"><i class="glyphicon glyphicon-transfer"></i>申请退款</button>
            <button type="button" id="outexcel" class="btn red-sunglo permit_2011406" data-toggle="modal" data-target="#myexcelModal"><i class="glyphicon glyphicon-arrow-down"></i>导出EXCEL</button>
            <button type="button" id="do_int_btn" class="btn red-sunglo permit_2011407"><i class="glyphicon glyphicon-resize-small"></i>批量介入</button>
        </div>
        <div class="col-md-12">
            <div class="portlet box red-sunglo">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-users" ></i>
                        退款记录
                    </div>
                </div>
                <div class="portlet-body" >
                    <table class="table table-hover" id="dataTable">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" class="checkbox" id="checkall">
                                </th>
                                <th sort='apply_time'>申请日期</th>
                                <th sort="rstatus">申请方式</th>
                                <th sort="reason">退款原因</th>
                                <th sort="name">客户姓名</th>
                                <th sort="ww">旺旺号</th>
                                <th sort="qq">QQ</th>
                                <th sort="mobile">客户电话</th>
                                <th sort="money">销售金额</th>
                                <th sort="arrears">欠款</th>
                                <th sort="payment">所属店铺</th>
                                <th sort="nick_name">所属客服</th>
                                <th sort='int_time'>介入时间</th>
                                <th sort="end_time">完成时间</th>
                                <th sort="delay_time">延长时间</th>
                                <th>处理人员</th>
                                <th>备注</th>
                                <th>#</th>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach:applyRefundList">
                            <tr>
                                <td>
                                    <input type="checkbox" class="checkbox" data-bind="value:id,attr:{tid:'check_'+id}">
                                </td>
                                <td data-bind="text:apply_time"></td>
                                <td>
                                    <span data-bind="if:rstatus==='退款'" class="label label-danger">退款</span>
                                    <span data-bind="if:rstatus==='售后'" class="label label-success">售后</span>
                                    <span data-bind="if:rstatus==='其他'" class="label label-success">其他</span>
                                </td>
                                <td data-bind="attr:{title:reason}">
                                    <div style="margin: 0 auto;max-width: 130px;text-overflow: clip;white-space: nowrap;overflow: hidden;" data-bind="text:reason"></div>
                                </td>
                                <td data-bind="text:name"></td>
                                <td data-bind="text:ww"></td>
                                <td data-bind="text:qq"></td>
                                <td data-bind="text:mobile"></td>
                                <td data-bind="text:money"></td>
                                <td data-bind="text:arrears"></td>
                                <td data-bind="text:payment"></td>
                                <td data-bind="text:nick_name"></td>
                                <td data-bind="text:int_time"></td>
                                <td data-bind="text:end_time"></td>
                                <td data-bind="text:delay_time"></td>
                                <td data-bind="text:done_username"></td>
                                <td data-bind="arra:{title:remark}">
                                    <div style="margin: 0 auto;max-width: 75px;text-overflow: clip;white-space: nowrap;overflow: hidden;" data-bind="text:remark"></div>
                                </td>
                                <td data-bind="attr:{'id':'customer_td_'+id}">
                                    <!-- ko if:dele -->
                                    <span data-bind="click:$root.delRefund" aria-hidden="true" class="icon-trash" style="cursor: pointer;margin-left: 10px;" title="删除"></span>
                                    <!-- /ko -->
                                    <!--ko if:edit-->
                                    <span data-bind="click:$root.editRefund" aria-hidden="true" class="icon-note" style="cursor: pointer;margin-left: 10px;" title="编辑"></span>
                                    <!-- /ko -->
                                    <!--ko if:show-->
                                    <span data-bind="click:$root.showRefund" aria-hidden="true" class="icon-magnifier" style="cursor: pointer;margin-left: 10px;" title="查看"></span>
                                    <!-- /ko -->
                                    <!--ko if:do_int-->
                                    <span data-bind="click:$root.do_int" aria-hidden="true" class="glyphicon glyphicon-resize-small" style="cursor: pointer;margin-left: 10px;font-size:17px;" title="介入退款"></span>
                                    <!-- /ko -->
                                    <!--ko if:done-->
                                    <span data-bind="click:$root.doneRefund" data-toggle="modal" data-target="#remarkModal" aria-hidden="true" class="glyphicon glyphicon-ok" style="cursor: pointer;margin-left: 10px;" title="完成"></span>
                                    <!-- /ko -->        
                                </td>
                            </tr>
                            <tr style="display: none;" class="second_tr" data-bind="attr:{'id':'tr_'+id}">
                                <td colspan="4"></td>
                                <td colspan="10">
                                    <form data-bind="attr:{'id':'form_'+id}">
                                        <input type="hidden" name="id" id="id" data-bind="value:id"/>
                                        <table class="table second_table">
                                            <tr>
                                                <th>申请日期：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control date-time-picker-bind-mouseover" data-date-format="yyyy-mm-dd hh:ii:ss" name="apply_time" id="apply_time" placeholder="申请日期" data-bind="value:apply_time"/>
                                                </td>
                                                <th>销售记录添加时间：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="sale_addtime" id="sale_addtime" placeholder="销售记录添加时间" data-bind="value:sale_addtime"/>
                                                </td>
                                                <th>延长时间：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control date-picker-bind-mouseover" data-date-format="yyyy-mm-dd" name="delay_time" id="delay_time" placeholder="延长时间" data-bind="value:delay_time"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>完成时间：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="end_time" id="end_time" placeholder="完成时间" data-bind="value:end_time"/>
                                                </td>
                                                <th>介入时间：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="int_time" id="int_time" placeholder="销售金额" data-bind="value:int_time"/>
                                                </td>
                                                <th>客户姓名：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="name" id="name" placeholder="客户姓名" data-bind="value:name"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>客户电话：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="mobile" id="mobile" placeholder="客户电话" data-bind="value:mobile"/>
                                                </td>
                                                <th>旺旺号：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="ww" id="ww" placeholder="旺旺号" data-bind="value:ww"/>
                                                </td>
                                                <th>QQ：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="qq" id="qq" placeholder="QQ" data-bind="value:qq"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>销售金额：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="money" id="money" placeholder="销售金额" data-bind="value:money"/>
                                                </td>
                                                <th>所属店铺：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="payment" id="payment" placeholder="所属店铺" data-bind="value:payment"/>
                                                </td>
                                                <th>所属客服：</th>
                                                <td>
                                                    <input type="text" class="form-control" name="nick_name" id="nick_name" placeholder="所属客服" data-bind="value:nick_name"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>申请方式：</th>
                                                <td>
                                                    <select readonly="" class="form-control" placeholder="申请方式" id="rstatus" name="rstatus" data-bind="value:rstatus">
                                                        <option value="退款">退款</option>
                                                        <option value="售后">售后</option>
                                                        <!--                                                        <option value="400">400</option>
                                                                                                                <option value="站内信">站内信</option>
                                                                                                                <option value="负面">负面</option>
                                                                                                                <option value="店铺">店铺</option>
                                                                                                                <option value="官网">官网</option>
                                                                                                                <option value="邮箱">邮箱</option>
                                                                                                                <option value="旺旺">旺旺</option>-->
                                                        <option value="其他">其他</option>
                                                    </select>
                                                </td>
                                                <th>处理人员：</th>
                                                <td>
                                                    <input type="text" readonly="" class="form-control" name="done_username" id="done_username" placeholder="处理人员" data-bind="value:done_username"/>
                                                    <input type="hidden" name="done_userid" id="done_userid" data-bind="value:done_userid"/>
                                                </td>
                                                <td></td><td></td>
                                            </tr>
                                            <tr>
                                                <th>退款原因：</th>
                                                <td colspan="5">
                                                    <input type="text" class="form-control" placeholder="退款原因" id="reason" name="reason" data-bind="value:reason"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>备注：</th>
                                                <td colspan="5">
                                                    <textarea type="text" class="form-control" placeholder="备注" id="remark" name="remark" data-bind="value:remark"></textarea>
                                                </td>
                                            </tr>
                                            <td colspan="6">
                                                <button type="button" class="btn btn-primary submit_btn dept_submit_btn" style="display: none;" data-bind="attr:{'id':'submit_'+id,'val':id}">提交</button>
                                                <button type="button" class="btn btn-info cancel_btn" style="display: none;" data-bind="attr:{'id':'cancel_'+id},click:$root.cancelTr">取消</button>
                                            </td>
                                            </tr>
                                        </table>
                                    </form>
                                </td>
                                <td colspan="4"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="paging-container"></div>
                </div>
            </div>
        </div>
        <script src="../../assets/global/plugins/jquery-1.11.0.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>

        <script src="../../assets/global/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery-validation/js/additional-methods.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/bootstrap-toastr/toastr.min.js" type="text/javascript"></script>
        <script src="../../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>

        <script src="../../assets/global/plugins/jstree/dist/jstree.min.js"></script>
        <script src="../../assets/local/plugins/json.js" type="text/javascript"></script>
        <script src="../../assets/local/plugins/base64encode.js" type="text/javascript"></script>
        <script src="../../assets/local/knockout/knockout-3.1.0.js" type="text/javascript"></script>
        <script>
            document.write("<script src='../../assets/local/ycoa.js?ts=" + Math.random() + "' type='text/javascript'></\script>");
            document.write("<script src='../../assets/local/sale/apply_refund.js?ts=" + Math.random() + "' type='text/javascript'></\script>");
            document.write("<script src='../../assets/local/sale/apply_refund-form-validate.js?ts=" + Math.random() + "' type='text/javascript'></\script>");
        </script>
        <!--<script src="../../assets/local/ycoa.js" type="text/javascript"></script>-->
        <!--<script src="../../assets/local/sale/apply_refund.js" type="text/javascript"></script>-->
        <!--<script src="../../assets/local/sale/apply_refund-form-validate.js" type="text/javascript"></script>-->
        <script src="../../assets/local/basePermit.js" type="text/javascript"></script>
    </body>
</html>